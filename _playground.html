<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
<div id="jsContainer">
  <ul class="js-test" id="jsParent">
    <li data-index="0">1</li>
    <li data-index="1">2</li>
  </ul>
  <span style="font-weight: bold;">3</span>
  4
</div>
</body>
<script>
  function dom2json() {
    const dfs = (node) => {
      if (node instanceof Text /* nodeType === 3 */) {
        const text = node.nodeValue.trim()
        return text ? {tag: 'text', content: text} : null
      }
      const res = {
        tag: node.tagName.toLowerCase(),
        attributes: {},
        children: []
      }
      for (let i = 0; i < node.attributes.length; i++) {
        res.attributes[node.attributes[i].name] = node.attributes[i].value
      }
      for (let i = 0; i < node.childNodes.length; i++) {
        let r = dfs(node.childNodes[i])
        r && res.children.push(r)
      }
      return res
    }

    return dfs(document.querySelector('#jsContainer'))
  }

  console.log(dom2json())
</script>
</html>
